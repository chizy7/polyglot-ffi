.TH POLYGLOT-FFI-WATCH 1 "2025-01-22" "v0.4.1" "Polyglot FFI Manual"
.SH NAME
polyglot-ffi-watch \- Watch for changes and auto-regenerate bindings
.SH SYNOPSIS
.B polyglot-ffi watch
[\fIoptions\fR] [\fIpath\fR]
.SH DESCRIPTION
Monitors OCaml interface files (.mli) for changes and automatically regenerates
FFI bindings when files are modified. Provides instant feedback during
development with a 0.5 second debounce to prevent rapid retriggers.
.PP
Uses efficient OS-level file system notifications (inotify on Linux, FSEvents
on macOS, ReadDirectoryChangesW on Windows) for minimal CPU usage.
.SH OPTIONS
.TP
.B path
Directory or file to watch. Default: current directory
.TP
.B \-c, \-\-config PATH
Path to configuration file. Default: ./polyglot.toml
.TP
.B \-\-debounce SECONDS
Debounce delay in seconds before regenerating. Default: 0.5
.TP
.B \-v, \-\-verbose
Enable verbose output showing detailed watch events
.TP
.B \-h, \-\-help
Show help message and exit
.SH BEHAVIOR
.TP
.B File Events
Watch mode responds to:
.IP \(bu 2
File modifications (.mli files)
.IP \(bu 2
File creations (new .mli files)
.IP \(bu 2
File deletions (removes corresponding generated files)
.TP
.B Ignored Events
The following are ignored:
.IP \(bu 2
Directory modifications
.IP \(bu 2
Non-.mli files
.IP \(bu 2
Generated files in output directories
.IP \(bu 2
Hidden files and .git directories
.SH WORKFLOW
Watch mode provides an efficient development workflow:
.IP 1. 3
Edit your .mli interface file
.IP 2. 3
Save the file
.IP 3. 3
Bindings are automatically regenerated (after 0.5s delay)
.IP 4. 3
See results immediately with rich console output
.SH EXAMPLES
.TP
Watch current directory:
.EX
$ polyglot-ffi watch
.EE
.TP
Watch specific directory:
.EX
$ polyglot-ffi watch src/
.EE
.TP
Watch with custom configuration:
.EX
$ polyglot-ffi watch --config custom.toml
.EE
.TP
Watch with custom debounce:
.EX
$ polyglot-ffi watch --debounce 1.0
.EE
.SH OUTPUT
Watch mode displays:
.IP \(bu 2
Start message with watched directory
.IP \(bu 2
File change events with timestamps
.IP \(bu 2
Generation progress with rich formatting
.IP \(bu 2
Success/error status for each regeneration
.IP \(bu 2
Statistics (files generated, time taken)
.SH SIGNALS
.TP
.B SIGINT (Ctrl+C)
Gracefully stop watching and exit
.TP
.B SIGTERM
Gracefully stop watching and exit
.SH EXIT STATUS
.TP
.B 0
Normal exit (user interrupted with Ctrl+C)
.TP
.B 1
Error (failed to start watcher or configuration error)
.SH PERFORMANCE
Watch mode is designed for efficiency:
.IP \(bu 2
OS-level file system events (no polling)
.IP \(bu 2
0.5 second debounce prevents rapid retriggers
.IP \(bu 2
Only regenerates affected files
.IP \(bu 2
Minimal CPU usage when idle
.SH SEE ALSO
.BR polyglot-ffi (1),
.BR polyglot-ffi-generate (1),
.BR polyglot-ffi-config (5)
.SH NOTES
Watch mode is ideal for iterative development. Make changes to your interface
files and see the generated bindings update immediately.
.PP
For production builds, use \fBpolyglot-ffi generate\fR directly instead of
watch mode.
